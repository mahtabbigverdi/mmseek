  0%|                                                                    | 0/3125 [00:00<?, ?it/s]/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|â–                                                        | 9/3125 [02:00<10:16:18, 11.87s/it]Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/mmseek/Qwen2.5-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 292, in <module>
    train(attn_implementation="flash_attention_2")
  File "/mmfs1/gscratch/krishna/mahtab/mmseek/Qwen2.5-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 280, in train
    trainer.train()
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 2560, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 3736, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 3801, in compute_loss
    outputs = model(**inputs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 20, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2131, in forward
    loss = self.module(*inputs, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1782, in inner
    args_result = hook(self, args)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/parameter_offload.py", line 298, in _pre_forward_module_hook
    self.pre_sub_module_forward_function(module)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/parameter_offload.py", line 473, in pre_sub_module_forward_function
    param_coordinator.fetch_sub_module(sub_module, forward=True)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 20, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/partitioned_param_coordinator.py", line 391, in fetch_sub_module
    if _is_currently_on_nvme(param_in_trace.param):
  File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/partitioned_param_coordinator.py", line 375, in _is_currently_on_nvme
    def _is_currently_on_nvme(param):
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mmfs1/gscratch/krishna/mahtab/mmseek/Qwen2.5-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 292, in <module>
[rank0]:     train(attn_implementation="flash_attention_2")
[rank0]:   File "/mmfs1/gscratch/krishna/mahtab/mmseek/Qwen2.5-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 280, in train
[rank0]:     trainer.train()
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 2560, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 3736, in training_step
[rank0]:     loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/transformers/trainer.py", line 3801, in compute_loss
[rank0]:     outputs = model(**inputs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 20, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2131, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
[rank0]:     return inner()
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1782, in inner
[rank0]:     args_result = hook(self, args)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/parameter_offload.py", line 298, in _pre_forward_module_hook
[rank0]:     self.pre_sub_module_forward_function(module)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/parameter_offload.py", line 473, in pre_sub_module_forward_function
[rank0]:     param_coordinator.fetch_sub_module(sub_module, forward=True)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 20, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/partitioned_param_coordinator.py", line 391, in fetch_sub_module
[rank0]:     if _is_currently_on_nvme(param_in_trace.param):
[rank0]:   File "/gscratch/krishna/mahtab/miniconda3/envs/qwen2vl/lib/python3.10/site-packages/deepspeed/runtime/zero/partitioned_param_coordinator.py", line 375, in _is_currently_on_nvme
[rank0]:     def _is_currently_on_nvme(param):
[rank0]: KeyboardInterrupt
